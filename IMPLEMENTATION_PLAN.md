# Plan: Fix Sidebar Issues and Generate Monthly Archive Pages

## Context

The WordPress-to-static-site migration is live, but several sidebar widgets are broken or outdated, and monthly archive pages (e.g., `/2024/08/`) were never generated by Simply Static, causing 404s. All 1,183 HTML files share an identical sidebar, so bulk find/replace operations will work cleanly.

---

## Task 1: Remove email subscription widget

**What:** Delete the `<aside id="blog_subscription-2">...</aside>` block from all 1,183 HTML files. The Jetpack subscription form no longer functions on a static site.

**How:** Use `sed` to delete everything from `<aside id="blog_subscription-2"` through the next `</aside>` on all `*.html` files. The widget varies slightly per page (the `source` and `_wp_http_referer` hidden fields differ), but the start/end tags are consistent.

---

## Task 2: Replace Twitter link with Threads

**What:** Replace the Twitter follow button widget (`<aside id="custom_html-2">`) content with a simple Threads link.

**How:** Use `sed` or Python to replace the entire `<aside id="custom_html-2">...</aside>` block across all files. The new content will be:
```html
<aside id="custom_html-2" class="widget_text widget widget_custom_html"><div class="textwidget custom-html-widget"><a href="https://www.threads.com/@postlibertarian">Follow @postlibertarian on Threads</a></div></aside>
```

---

## Task 3: Add Calibrations link to the Blogroll

**What:** Add a link to `https://www.calibrations.blog/` in the existing Blogroll widget (`<aside id="linkcat-20">`).

**How:** Insert a new `<li>` entry into the Blogroll `<ul>` in all files. Insert it as the first item (or alphabetically — user can decide). The entry:
```html
<li><a href="https://www.calibrations.blog/" title="Calibrations blog">Calibrations</a></li>
```

**Approach:** Find the string `<ul class="xoxo blogroll">` and insert the new `<li>` after it, across all files.

---

## Task 4: Remove Meta sidebar section

**What:** Delete the `<aside id="meta-2">...</aside>` block from all files. Contains dead links (wp-login, feeds, wordpress.org).

**How:** Same approach as Task 1 — use `sed` to delete from `<aside id="meta-2"` through its closing `</aside>`.

---

## Task 5: Generate monthly archive index pages

**What:** Create `index.html` files for all 97 year/month directories so that URLs like `/2024/08/` display a list of posts from that month instead of 404ing. Both the Archives page (`/archives/index.html`) and the sidebar dropdown link to these URLs.

**How:** Write a Python script that:

1. **Scans** all post directories to build a mapping of year/month → list of posts (title, date, URL)
2. **Extracts titles and dates** from each post's `index.html` by parsing the `<h1 class="entry-title">` and `<time class="entry-date published">` tags
3. **Generates** an `index.html` for each year/month using the same page template as the rest of the site:
   - Copy `<head>` from an existing page (with appropriate `<title>`)
   - Copy the sidebar (already modified by Tasks 1–4, so run this task last)
   - Content area contains a simple list of post links for that month, styled like the Archives page
   - Copy the footer
4. Posts within each month sorted by date (newest first)

**Template for content area:**
```html
<article class="page type-page status-publish hentry">
  <header class="entry-header">
    <h1 class="entry-title">August 2024</h1>
  </header>
  <div class="entry-content">
    <ul>
      <li><a href="/2024/08/15/should-we-let-ourselves-see-the-future/">Should we let ourselves see the future?</a> — 2024-08-15</li>
    </ul>
  </div>
</article>
```

**Key files:**
- Template source: any existing post's `index.html` (for head/sidebar/footer extraction)
- Archive directories: 97 year/month combinations across `/2011/` through `/2024/`
- Archives page: `/archives/index.html` — links already point to the correct URLs

---

## Execution Order

1. Tasks 1–4 (sidebar changes) — run as bulk sed/python operations across all files
2. Task 5 (archive pages) — run after sidebar changes so generated pages have the correct sidebar
3. Re-run Pagefind to update the search index with new archive pages
4. Commit and push

## Verification

- Visually spot-check a few pages to confirm sidebar changes look correct
- Verify a monthly archive URL (e.g., `/2024/08/index.html`) exists and contains the expected post list
- Confirm Pagefind re-indexes successfully
- After push, verify on the live site
